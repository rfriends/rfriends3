<?php
 global $radiru_vod_url; $ex_type = $ex_radiru_vod; ht_subtitle($subno,""); switch ($subno) { case "0501": $ht_jump_btn1_label = "選択"; $bc = rf_nhk_mcode2ch($val); $ond = ond_corners(0,0,$bc); $cnt = count_73($ond); ond_select_new($ond, $val); break; case "0502": $station = ""; $sch = ""; if (!is_array($val2)) $val2 = array(); foreach($val2 as $v) { $station .= "$v "; if ($v == 'r1') $sch .= '5 '; if ($v == 'r2') $sch .= '6 '; if ($v == 'r3') $sch .= '7 '; } $sch = trim($sch); if ($sch == "") { echo_msg(2,"局が選択されていません。"); break; } echo_msg(2,"局 : $station"); $ht_jump_btn2 = 1; $ht_jump_btn3 = 1; $ht_jump_btn1_label = "録音"; $ht_jump_btn2_label = "聴取"; $ht_jump_btn3_label = "聴取(サーバ)"; ht_rec_kwsrc("検索結果",$multi_sw,$ex_type,$val,$sch); break; case "0503": if (is_array($val)) { $dat0 = $val; } else { $dat0[] = $val; } echo_msg(2, "録音日付"); if ($sel == 1) { $cnt = 1; $dt = ""; foreach($dat0 as $dat) { $dt0 = date("Ymd", $dat); echo_msg(2, "$dt0"); $dt .= $dt0."_"; } if ($dt == "") { echo_msg(2,"データがありません。"); break; } $dt = substr($dt,0,strlen($dt)-1); rf_batsh_rec($ex_type, 2, $dt, $cnt, ""); } else { $r = rfmenu_rec_date_calc($ex_type); $dt = $r[0]; $cnt = $r[1]; $dt1 = time()+ $dt*24*3600; $dt2 = $dt1 + ($cnt-1)*24*3600; $fmt1 = rfmenu_rec_date_fmt2($dt1); $fmt2 = rfmenu_rec_date_fmt2($dt2); rf_batsh_rec($ex_type, 1, $dt1, $cnt, ""); echo_msg(2, "$fmt1 - $fmt2"); } echo_msg(2,""); echo_msg(2, "らじる聞き逃し録音（キーワードファイル）を開始しました。"); break; case "0504": if ($sel == 1) { ht_webaudio($val,$radiru_vod_recdir); } else if ($sel == 2) { ht_play_server($val,$radiru_vod_recdir); } break; default: ht_development($subno,$val,2); break; } 